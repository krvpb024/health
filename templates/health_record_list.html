{% extends "layout.html" %}

{%- block title -%}我的記錄{%- endblock -%}

{%- block head -%}
<link rel="stylesheet" href="./static/health_record_list.css">
{%- endblock -%}

{%- block content -%}
<main>
  <section aria-labelledby="base-title">
    <h1 id="base-title">我的記錄</h1>

    <table class="record-table">
      <caption class="caption">健康記錄</caption>

      <thead>
        <tr>
          <th scope="col">日期</th>
          <th scope="col">身高（cm）</th>
          <th scope="col">體重（kg）</th>
          <th scope="col">BMI</th>
          <th scope="col">體脂率（%）</th>
          <th scope="col">腰圍（cm）</th>
          <th scope="col">資料操作</th>
        </tr>
      </thead>

      <tbody>
        {%- for healthRecord in healthRecordList -%}
        <tr>
          <td>{{ healthRecord.recordDate }}</td>
          <td>{{ healthRecord.height }}</td>
          <td>{{ healthRecord.weight }}</td>
          <td>{{ healthRecord.bmi }}</td>
          <td>
            {%- if healthRecord.bodyFatPercentage -%}
            {{ healthRecord.bodyFatPercentage }}%
            {%- endif -%}
          </td>
          <td>
            {%- if healthRecord.waistlineCm -%}
            {{ healthRecord.waistlineCm }}
            {%- endif -%}
          </td>
          <td>
            <a href="/health_record/{{ healthRecord['recordId'] }}/form">編輯</a>

            <details>
              <summary class="delete-summary">刪除</summary>

              <p id="delete-form-title">確認刪除記錄</p>

              <form action="/health_record/{{ healthRecord['recordId'] }}/delete" method="post"
                aria-labelledby="delete-form-title">
                <button type="submit">確認</button>
              </form>
            </details>
          </td>
        </tr>
        {%- endfor -%}
      </tbody>
    </table>
  </section>
</main>

<section aria-labelledby="filter-title">
  <h2 id="filter-title">篩選紀錄</h2>

  <form action="/health_record" method="get" aria-labelledby="自訂區間" role="search">
    <fieldset>
      <legend>由日期篩選</legend>

      <a href="/health_record?from={{ navFilterRange['pastWeekFrom'] }}&to={{ navFilterRange['now'] }}">過去七天</a>
      <a href="/health_record?from={{ navFilterRange['pastMonthFrom'] }}&to={{ navFilterRange['now'] }}">過去三十天</a>

      <label for="custom-filter-from-input" class="custom-filter-label">從</label>
      <input type="date" name="from" id="custom-filter-from-input" value="{{ queryRange.from}}">
      <label for="custom-filter-to-input" class="custom-filter-label">到</label>
      <input type="date" name="to" id="custom-filter-to-input" value="{{ queryRange.to}}">
    </fieldset>
    <button type="submit">送出</button>
  </form>
  <form action="/health_record" method="get" aria-labelledby="自訂區間" role="search">
    <fieldset>

      <legend>篩選近期紀錄</legend>

      <a href="/health_record?latestRecord=10">最近 10 筆</a>
      <a href="/health_record?latestRecord=30">最近 30 筆</a>

      <label for="latest-record-input">顯示最近幾筆</label>
      <input type="number" name="latestRecord" id="latest-record-input" value="{{ latestRecord }}">
    </fieldset>
    <button type="submit">送出</button>
  </form>
</section>
{%- endblock -%}
